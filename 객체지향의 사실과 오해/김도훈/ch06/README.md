# 객체 지도

길을 알려주는 방법 : 기능적이고 해결 방법 지향적인 접근법

지도를 이용하는 방법 : 구조적이고 문제 지향적인 접근법

지도는 길을 찾는 데 필요한 구체적인 기능이 아니라 길을 찾을 수 있는 **구조**를 제공한다.

사람들의 요구사항은 계속 변하기 때문에 모델이 제공해야 하는 기능 역시 이에 따라 지속적으로 변할 수 밖에 없다. 

- **기능을 중심으로 구조를 종속시키는 접근법(길을 알려주는 방법)** : 범용적이지 않고 재사용이 불가능하며 변경에 취약한 모델을 낳게 됨.
- **안정적인 구조를 중심으로 기능을 종속시키는 접근법(지도를 이용하는 방법)** : 범용적이고 재사용 가능하며 변경에 유연하게 대처할 수 있는 모델을 낳게 됨.

**자주 변경되는 기능이 아니라 안정적인 구조를 따라 역할, 책임, 협력을 구성하라**

## 기능 설계 대 구조 설계

모든 소프트웨어 제품의 설계에 존재하는 두 가지 측면

- **기능(function)** : 제품이 사용자를 위해 무엇을 할 수 있는지에 초점을 맞춤
- **구조(structure)** : 제품의 형태가 어떠해야 한느지에 초점을 맞춤

훌륭한 기능 :  훌륭한 소프트웨어를 만드는 충분조건

훌륭한 구조 : 훌륭한 소프트웨어를 만들기 위한 필요조건

미래의 변경에 대비하는 가장 좋은 방법은 변경을 예측하는 것이 아니라 변경을 수용할 수 있는 선택

의 여지를 설계에 마련해 놓는 것이다.

## 두 가지 재료: 기능과 구조

객체지향 세계를 구축하기 위해서는 사용자에게 제공할 **기능**과 기능을 담을 안정적인 **구조**라는 재료가 준비돼 있어야 한다.

- 기능 : 사용자가 자신의 목표를 달성하기 위해 사용할 수 있는 시스템의 서비스
- 구조 : 시스템의 기능을 구현하기 위한 기반으로, 기능 변경을 수용할 수 있도록 안정적이어야 함.

기능과 구조를 표현하기 위해 일관되게 적용할 수 있는 두 가지 기법

1. 구조는 사용자나 이해관계자들이 도메인에 관해 생각하는 개념과 개념들 간의 관계로 표현한다.
2. 기능은 사용자의 목표를 만족시키기 위해 책임을 수행하는 시스템의 행위로 표현한다.

- **유스케이스 모델링** : 일반적으로 기능을 수집하고 표현하기 위한 기법
- **도메인 모델링** : 구조를 수집하고 표현하기 위한 기법

## 안정적인 재료: 구조

### 도메인 모델

병원에서는 환자의 진료 기록을 관리하기 위한 소프트웨어, 은행에서는 고객의 자산을 관리하고 보호하기 위한 소프트웨어, 무료한 시간을 달래기 위한 게임 소프트웨어 등 소프트웨어를 사용하는 사람들은 자신이 관심을 가지고 있는 특정한 분야의 문제를 해결하기 위해 소프트웨어를 사용한다. 이처럼 사용자가 프로그램을 사용하는 대상 분야를 **도메인**이라고 한다.

**도메인 모델** : 사용자가 프로그램을 사용하는 대상 영역에 관한 지식을 선택적으로 단순화하고 의식적으로 구조화한 형태. 소프트웨어가 목적하는 영역 내의 개념과 개념 간의 관계, 다양한 규칙이나 제약 등을 주의 깊게 추상화한 것.

### 도메인의 모습을 담을 수 있는 객체지향

도메인 모델의 세 가지 측면을 모두 모델링할 수 있는 유사한 모델링 패러다임을 사용할수록 소프트웨어 개발이 쉬워질 것이다. 객체지향은 이런 요구사항을 가장 범용적으로 만족시킬 수 있는 거의 유일한 모델링 패러다임이다.

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/0a08179c-6898-4f98-8b89-2a2ddd15c8b3/c284c4d3-50b7-42c8-88c9-8f5e5af8f93e/image.png)

객체지향을 이용하면 도메인에 대한 사용자 모델, 디자인 모델, 시스템 이미지 모두가 유사한 모습을 유지하도록 만드는 것이 가능하다. 객체지향의 이러한 특징을 **연결완전성** 또는 **표현적 차이**라고 한다.

### 표현적 차이

소프트웨어 객체는 현실 객체에 대한 추상화가 아니다. 소프트웨어 객체는 현실 객체를 모방한 것이 아니라 은유를 기반으로 재창조한 것이다. 따라서 소프트웨어 객체는 현실 객체가 갖지 못한 특성을 가질 수도 있고 현실 객체가 하지 못하는 행동을 할 수도 있다.

비록 소프트웨어 객체가 현실 객체를 왜곡한다고 하더라도 소프트웨어 객체는 현실 객체의 특성을 토대로 구축된다. 이처럼 소프트웨어 객체와 현실 객체 사이의 의미적 거리를 **표현적 차이** 또는 **의미적 차이**라고 한다. 핵심은 은유를 통해 현실 객체와 소프트웨어 객체 사이의 차이를 최대한 줄이는 것이다.

표현적 차이가 중요한 이유

1. 소프트웨어를 이해하고 수정하기 쉽게 만들어준다.
    - 코드의 구조가 도메인의 구조를 반영하기 때문에 도메인을 이해하면 코드를 이해하기가 훨씬 수월해진다.
2. 도메인 모델이 제공하는 구조가 상대적으로 안정적이다.
    - 도메인 모델의 핵심은 사용자가 도메인을 바라보는 관점을 반영해 소프트웨어를 설계하고 구현하는 것이다. 도메인에 대한 사용자의 관점을 반영해야 하는 이유는 사용자들이 누구보다도 도메인의 **본질적인** 측면을 가장 잘 이해하고 있기 때문이다.

결론적으로 안정적인 구조를 제공하는 도메인 모델을 기반으로 소프트웨어의 구조를 설계하면 변경에 유연하게 대응할 수 있는 탄력적인 소프트웨어를 만들 수 있다.

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/0a08179c-6898-4f98-8b89-2a2ddd15c8b3/b4307000-2f6c-4db5-95ac-77f294528e72/image.png)

실제 운영되는 정기예금 상품을 매우 단순화한 것이지만 일반적으로 사람들이 정기예금에 관해 생각하는 개념과 규칙을 모두 포함하고 있다. 중요한 것은 이 모델이 **안정적**이라는 것이다.

이 모델에서 사용하고 있는 개념의 정의와 속성은 은행 업무에서 다뤄지는 정기예금의 **정의가 변경되지 않는 한** 쉽게 바뀌지 않을 것이다. 개념과 개념 간의 관계는 정기예금과 관련된 **중요한 비즈니스 규칙과 정책을 반영**하고 있다. 도메인 모델의 **장점**은 비즈니스의 개념과 정책을 반영하는 안정적인 구조를 제공한다는 것이다.

- **유스케이스**라는 기법을 사용해 기술할 수 있다.

## 불안정한 재료: 기능

### 유스케이스

사용자는 자신의 목표를 달성하기 위해 시스템과의 상호작용을 시작한다. 사용자가 시스템에게 작업을 요청하면 시스템은 요청을 처리한 후 사용자에게 원하는 결과를 제공한다. 사용자는 이 작업을 반복하게 된다.

이처럼 사용자의 목표를 달성하기 위해 사용자와 시스템 간에 이뤄지는 상호작용의 흐름을 텍스트로 정리한 것을 **유스케이스**라고 한다.

## 재료 합치기: 기능과 구조의 통합

### 도메인 모델, 유스케이스, 그리고 책임-주도 설계

변경에 유연한 소프트웨어를 만들기 위해서는 유스케이스에 정리된 시스템의 기능을 도메인 모델을 기반으로 한 객체들의 책임으로 분배해야 한다.

사용자의 관점에서 시스템은 자신이 전송한 메시지에 응답하는 데 필요한 책임을 수행하는 일종의 객체다. 시스템이라는 객체 안에는 더 작은 규모의 객체가 포함될 수 있고, 시스템이 수행해야 하는 커다란 규모의 책임은 시스템 안에 있는 더 작은 크기의 객체들의 협력을 통해 구현될 수 있다.

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/0a08179c-6898-4f98-8b89-2a2ddd15c8b3/203e4a76-f873-47dc-9e30-d131eb982ade/image.png)

시스템에 할당된 커다란 책임은 시스템 안의 작은 규모의 객체들이 수행해야 하는 더 작은 규모의 책임으로 세분화된다.

그렇다면 어떤 객체를 선택할 것인가?

- **도메인 모델**에 포함된 개념을 은유하는 소프트웨어 객체를 선택해야 한다. (안정적인 도메인 모델을 참고한다는 것 같음)
- **유스케이스**는 사용자에게 제공할 기능을 시스템의 책임으로 보게 함으로써 객체 간의 안정적인 구조에 책임을 분배할 수 있는 출발점을 제공한다.

**책임-주도 설계**는 유스케이스로부터 첫 번째 메시지와 사용자가 달성하려는 목표를, 도메인 모델로부터 기능을 수용할 수 있는 안정적인 구조를 제공받아 실제로 동작하는 객체들의 협력 공동체를 창조한다.

### 기능 변경을 흡수하는 안정적인 구조

객체지향의 가장 큰 장점은 도메인을 모델링하기 위한 기법과 도메인을 프로그래밍하기 위해 사용하는 기법이 동일하다는 점이다. 따라서 도메인 모델링에서 사용한 객체와 개념을 프로그래밍 설계에서의 객체와 클래스로 매끄럽게 변환할 수 있다. 객체지향의 이 같은 특성을 **연결완전성**이라고 한다.

객체지향에서는 도메인 모델과 코드 모두 동일한 모델링 패러다임을 공유하기 때문에 코드의 수정이 곧 모델의 수정이 된다. 이처럼 모델에서 코드로의 매끄러운 흐름을 의미하는 **연결완전성**과 반대로 코드에서 모델로의 매끄러운 흐름을 **가역성**이라고 한다.

**연결완전성** : 도메인 모델 → 코드

**가역성** : 코드 → 도메인 모델
